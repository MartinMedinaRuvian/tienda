"use strict";(self["webpackChunktienda_martin_front"]=self["webpackChunktienda_martin_front"]||[]).push([[328],{6328:function(t,e,o){o.r(e),o.d(e,{default:function(){return m}});var a=function(){var t=this,e=t._self._c;return e("div",[e("h5",[t._v("Productos:")]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"select"}},[t._v("Seleccione el filtro:")]),t.filtros.length>0?e("select",{directives:[{name:"model",rawName:"v-model",value:t.filtro,expression:"filtro"}],staticClass:"form-select form-control",attrs:{id:"select","aria-label":"Default select example"},on:{change:[function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.filtro=e.target.multiple?o:o[0]},function(e){return t.verProductos()}]}},t._l(t.filtros,(function(o){return e("option",{key:o.codigo,domProps:{value:o.codigo}},[t._v(" "+t._s(o.descripcion)+" ")])})),0):t._e()]),e("ProductoTablaComponente",{attrs:{productos:t.productos}})],1)},i=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-5"},[e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.productos,(function(o){return e("tr",{key:o.codigo},[e("td",[t._v(t._s(o.codigo))]),e("td",[t._v(t._s(o.descripcion))]),e("td",[t._v(t._s(o.valor))]),e("td",[t._v(t._s(o.cantidad))])])})),0)])])},c=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Código")]),e("th",{attrs:{scope:"col"}},[t._v("Descripción")]),e("th",{attrs:{scope:"col"}},[t._v("Valor")]),e("th",{attrs:{scope:"col"}},[t._v("Cant veces vendidas")])])])}],n={props:{productos:[]},methods:{async seleccionarProducto(t){const e=new Date,o=e.getDate(),a=e.getMonth()+1,i=e.getFullYear(),r=o+"-"+a+"-"+i,c=JSON.parse(localStorage.getItem("cliente")).identificacion,n={fecha:r,identificacionCliente:c,total:t.valor},s=await this.compraPendiente(c);if(null==s){const e=await this.validarCupoClienteNuevaCompra(c,t.valor);if(e){const e=await this.axios.post("compra",n);if(e){const o=e.data.numero;if(null!==o){const e={numeroCompra:o,codigoProducto:t.codigo,valor:t.valor},a=await this.axios.post("detalle_compra",e);a&&alert(a.data.mensaje)}}}else alert("El cliente seleccionado no tiene cupo suficiente")}else{const e=await this.productoYaEstaEnCarritoCliente(t.codigo,c);if(e)alert("El cliente seleccionado ya tiene agregado el producto "+t.descripcion);else{const e=await this.validarCupoClienteCompraPendiente(c,t.valor);if(e){const e={numeroCompra:s.numero,codigoProducto:t.codigo,valor:t.valor},o=await this.axios.post("detalle_compra",e);o&&alert(o.data.mensaje)}else alert("El cliente seleccionado no tiene cupo suficiente")}}},async validarCupoClienteCompraPendiente(t,e){const o=await this.axios.get("cupo_compra/"+t+"/"+e);return o.data},async validarCupoClienteNuevaCompra(t,e){const o=await this.axios.get("cupo_compra/nueva_compra/"+t+"/"+e);return o.data},async compraPendiente(t){const e={identificacionCliente:t,estado:"PENDIENTE"},o=await this.axios.post("compra/info",e);return o.data},async productoYaEstaEnCarritoCliente(t,e){const o=await this.axios.get("detalle_compra/verificar_producto_carrito/"+t+"/"+e);return o.data}}},s=n,l=o(1001),d=(0,l.Z)(s,r,c,!1,null,null,null),u=d.exports,p={name:"inicioView",components:{ProductoTablaComponente:u},data(){return{productos:[],filtros:[{codigo:1,descripcion:"Cliente Seleccionado"},{codigo:2,descripcion:"Todas las Compras"}],filtro:2}},created(){this.verProductos()},methods:{async verProductos(){const t=JSON.parse(localStorage.getItem("cliente"));let e="TODOS";1==this.filtro&&(null!==t?e=t.identificacion:(alert("Debe seleccionar un cliente"),this.filtro=2));const o=await this.axios.get("producto/comprados/"+e);this.productos=o.data}}},f=p,v=(0,l.Z)(f,a,i,!1,null,null,null),m=v.exports}}]);
//# sourceMappingURL=328.149da0fc.js.map