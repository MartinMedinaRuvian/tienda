"use strict";(self["webpackChunktienda_martin_front"]=self["webpackChunktienda_martin_front"]||[]).push([[472],{9472:function(t,o,e){e.r(o),e.d(o,{default:function(){return v}});var a=function(){var t=this,o=t._self._c;return o("div",[o("h5",[t._v("Productos:")]),o("ProductoTablaComponente",{attrs:{productos:t.productos}})],1)},i=[],n=function(){var t=this,o=t._self._c;return o("div",{staticClass:"mt-5"},[o("table",{staticClass:"table"},[t._m(0),o("tbody",t._l(t.productos,(function(e){return o("tr",{key:e.codigo},[o("td",[t._v(t._s(e.codigo))]),o("td",[t._v(t._s(e.descripcion))]),o("td",[t._v(t._s(e.valor))]),o("td",[o("button",{staticClass:"btn btn-outline-warning",on:{click:function(o){return t.seleccionarProducto(e)}}},[t._v(" Agregar al carrito ")])])])})),0)])])},c=[function(){var t=this,o=t._self._c;return o("thead",{staticClass:"thead-light"},[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("Código")]),o("th",{attrs:{scope:"col"}},[t._v("Descripción")]),o("th",{attrs:{scope:"col"}},[t._v("Valor")]),o("th",{attrs:{scope:"col"}},[t._v("Acciones")])])])}],r={props:{productos:[]},methods:{async seleccionarProducto(t){if(this.noHayClienteSeleccionado())alert("Debe seleccionar un cliente primero");else{const o=new Date,e=o.getDate(),a=o.getMonth()+1,i=o.getFullYear(),n=e+"-"+a+"-"+i,c=JSON.parse(localStorage.getItem("cliente")).identificacion,r={fecha:n,identificacionCliente:c,total:t.valor},s=await this.compraPendiente(c);if(null==s){const o=await this.validarCupoClienteNuevaCompra(c,t.valor);if(o){const o=await this.axios.post("compra",r);if(o){const e=o.data.numero;if(null!==e){const o={numeroCompra:e,codigoProducto:t.codigo,valor:t.valor},a=await this.axios.post("detalle_compra",o);a&&alert(a.data.mensaje)}}}else alert("El cliente seleccionado no tiene cupo suficiente")}else{const o=await this.productoYaEstaEnCarritoCliente(t.codigo,c);if(o)alert("El cliente seleccionado ya tiene agregado el producto "+t.descripcion);else{const o=await this.validarCupoClienteCompraPendiente(c,t.valor);if(o){const o={numeroCompra:s.numero,codigoProducto:t.codigo,valor:t.valor},e=await this.axios.post("detalle_compra",o);e&&alert(e.data.mensaje)}else alert("El cliente seleccionado no tiene cupo suficiente")}}}},async validarCupoClienteCompraPendiente(t,o){const e=await this.axios.get("cupo_compra/"+t+"/"+o);return e.data},async validarCupoClienteNuevaCompra(t,o){const e=await this.axios.get("cupo_compra/nueva_compra/"+t+"/"+o);return e.data},async compraPendiente(t){const o={identificacionCliente:t,estado:"PENDIENTE"},e=await this.axios.post("compra/info",o);return e.data},async productoYaEstaEnCarritoCliente(t,o){const e=await this.axios.get("detalle_compra/verificar_producto_carrito/"+t+"/"+o);return e.data},noHayClienteSeleccionado(){return null==JSON.parse(localStorage.getItem("cliente"))}}},s=r,l=e(1001),d=(0,l.Z)(s,n,c,!1,null,null,null),u=d.exports,p={name:"inicioView",components:{ProductoTablaComponente:u},data(){return{productos:[]}},created(){this.verProductos()},methods:{async verProductos(){const t=await this.axios.get("producto");this.productos=t.data}}},m=p,h=(0,l.Z)(m,a,i,!1,null,null,null),v=h.exports}}]);
//# sourceMappingURL=472.577196cc.js.map